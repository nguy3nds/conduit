{"ast":null,"code":"var _jsxFileName = \"/Users/nguyencanhnguyen/Public/Development/condi-app/src/pages/Articles/index.tsx\",\n    _s = $RefreshSig$();\n\nimport { useEffect, useState } from \"react\";\nimport { useHistory, useParams } from \"react-router\";\nimport { NavLink } from \"react-router-dom\";\nimport { userByToken } from \"../../apis\";\nimport { deleteFavorite, postFavorite } from \"../Home/components/ArticlePreview/ArticleItem/apis\";\nimport { getProfile } from \"../Profile/apis\";\nimport { deleteArticle, deleteFollowing, getArticle, getArticleNoToken, postFollowing } from \"./apis\";\nimport Comment from \"./Components/Comment\";\nimport AlertDialog from \"../../components/Modals/AlertDialog\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Articles() {\n  _s();\n\n  var _article$author, _article$author2, _article$author3, _article$author5, _article$author6, _article$tagList;\n\n  const {\n    slug\n  } = useParams();\n  const token = window.localStorage.getItem(\"jwtToken\");\n  const [article, setArticle] = useState();\n  const [checkAuthor, setCheckAuthor] = useState(false);\n  const [likeCount, setLikeCount] = useState(article === null || article === void 0 ? void 0 : article.favoritesCount);\n  const [likeState, setLikeState] = useState();\n  const [followState, setFollowState] = useState();\n  const [open, setOpen] = useState(false);\n  const history = useHistory();\n  useEffect(() => {\n    if (token) {\n      getArticle(slug, token).then(responseArticle => {\n        var _responseArticle$data, _responseArticle$data2;\n\n        setArticle(responseArticle.data.article);\n        setLikeState((_responseArticle$data = responseArticle.data.article) === null || _responseArticle$data === void 0 ? void 0 : _responseArticle$data.favorited);\n        setLikeCount((_responseArticle$data2 = responseArticle.data.article) === null || _responseArticle$data2 === void 0 ? void 0 : _responseArticle$data2.favoritesCount);\n        userByToken(token).then(responseUser => {\n          if (responseUser.data.user.username == responseArticle.data.article.author.username) setCheckAuthor(true);else setCheckAuthor(false);\n        });\n        getProfile(token, responseArticle.data.article.author.username).then(res => {\n          if (res.data.profile.following) setFollowState(true);else setFollowState(false);\n        });\n      });\n    } else {\n      getArticleNoToken(slug).then(res => {\n        setArticle(res.data.article);\n      });\n    }\n  }, [slug, token]);\n\n  const handleFavorite = slug => {\n    if (likeState) {\n      deleteFavorite(token, slug).then(res => {\n        var _res$data$article;\n\n        setLikeCount((_res$data$article = res.data.article) === null || _res$data$article === void 0 ? void 0 : _res$data$article.favoritesCount);\n        setLikeState(false);\n      });\n    } else {\n      postFavorite(token, slug).then(res => {\n        var _res$data$article2;\n\n        setLikeCount((_res$data$article2 = res.data.article) === null || _res$data$article2 === void 0 ? void 0 : _res$data$article2.favoritesCount);\n        setLikeState(true);\n      });\n    }\n  };\n\n  const handleFollowing = username => {\n    if (followState) {\n      deleteFollowing(token, username).then(res => {\n        // setLikeCount(res.data.article?.favoritesCount);\n        setFollowState(false);\n      });\n    } else {\n      postFollowing(token, username).then(res => {\n        // setLikeCount(res.data.article?.favoritesCount);\n        setFollowState(true);\n      });\n    }\n  };\n\n  const handleDelete = () => {\n    setOpen(true);\n  };\n\n  const handleAgree = () => {\n    deleteArticle(slug, token).then(res => {\n      history.push(\"\");\n    });\n    handleClose();\n  };\n\n  const handleClose = () => {\n    setOpen(false);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"article-page\",\n    children: [/*#__PURE__*/_jsxDEV(AlertDialog, {\n      open: open,\n      setOpen: setOpen,\n      slug: slug,\n      token: token,\n      handleAgree: handleAgree,\n      handleClose: handleClose\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"banner\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: article === null || article === void 0 ? void 0 : article.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"article-meta\",\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: (article === null || article === void 0 ? void 0 : (_article$author = article.author) === null || _article$author === void 0 ? void 0 : _article$author.image) ? article.author.image : \"https://static.productionready.io/images/smiley-cyrus.jpg\",\n            alt: \"\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 117,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"info\",\n            children: [/*#__PURE__*/_jsxDEV(NavLink, {\n              to: \"/profile/\" + (article === null || article === void 0 ? void 0 : (_article$author2 = article.author) === null || _article$author2 === void 0 ? void 0 : _article$author2.username),\n              children: /*#__PURE__*/_jsxDEV(\"h5\", {\n                children: article === null || article === void 0 ? void 0 : (_article$author3 = article.author) === null || _article$author3 === void 0 ? void 0 : _article$author3.username\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 127,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 126,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"date\",\n              children: article === null || article === void 0 ? void 0 : article.updatedAt\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 129,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 13\n          }, this), token ? /*#__PURE__*/_jsxDEV(\"div\", {\n            children: checkAuthor ? /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(NavLink, {\n                to: \"/editor/\" + (article === null || article === void 0 ? void 0 : article.slug),\n                children: /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"btn btn-sm btn-outline-secondary\",\n                  children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                    className: \"ion-edit\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 137,\n                    columnNumber: 25\n                  }, this), \"\\xA0 Edit Article\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 136,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 135,\n                columnNumber: 21\n              }, this), \"\\xA0\\xA0\", /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"btn btn-sm btn-outline-danger\",\n                onClick: handleDelete,\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"ion-trash-a\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 146,\n                  columnNumber: 23\n                }, this), \"\\xA0 Delete Article\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 142,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 134,\n              columnNumber: 19\n            }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"btn btn-sm btn-outline-secondary\",\n                onClick: () => {\n                  var _article$author4;\n\n                  return handleFollowing(article === null || article === void 0 ? void 0 : (_article$author4 = article.author) === null || _article$author4 === void 0 ? void 0 : _article$author4.username);\n                },\n                children: [followState ? /*#__PURE__*/_jsxDEV(\"i\", {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 157,\n                  columnNumber: 25\n                }, this) : /*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"ion-plus-round\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 159,\n                  columnNumber: 25\n                }, this), \"\\xA0\", \" \", followState ? `Unfollow ${article === null || article === void 0 ? void 0 : (_article$author5 = article.author) === null || _article$author5 === void 0 ? void 0 : _article$author5.username}` : `Follow ${article === null || article === void 0 ? void 0 : (_article$author6 = article.author) === null || _article$author6 === void 0 ? void 0 : _article$author6.username}`, /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"counter\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 165,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 152,\n                columnNumber: 21\n              }, this), \"\\xA0\\xA0\", /*#__PURE__*/_jsxDEV(\"button\", {\n                className: likeState ? \"btn btn-sm btn-primary\" : \"btn btn-sm btn-outline-primary\",\n                onClick: () => handleFavorite(article === null || article === void 0 ? void 0 : article.slug),\n                children: [likeState ? /*#__PURE__*/_jsxDEV(\"i\", {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 176,\n                  columnNumber: 36\n                }, this) : /*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"ion-heart\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 176,\n                  columnNumber: 46\n                }, this), \"\\xA0 \", likeState ? \"Unfavorite Post\" : \"Favorite Post\", /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"counter\",\n                  children: [\"(\", likeCount, \")\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 178,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 168,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 151,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 132,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 184,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container page\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row article-content\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-xs-12\",\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            children: article === null || article === void 0 ? void 0 : article.body\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 192,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"tag-list\",\n        children: article === null || article === void 0 ? void 0 : (_article$tagList = article.tagList) === null || _article$tagList === void 0 ? void 0 : _article$tagList.map(tag => /*#__PURE__*/_jsxDEV(\"span\", {\n          \"ng-repeat\": \"tag in $ctrl.article.tagList\",\n          className: \"tag-default tag-pill ng-binding ng-scope\",\n          children: tag\n        }, tag, false, {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Comment, {\n        slug: slug\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 104,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Articles, \"4BJM2TNQDrF3h/AlrAcrepVhEsU=\", false, function () {\n  return [useParams, useHistory];\n});\n\n_c = Articles;\n\nvar _c;\n\n$RefreshReg$(_c, \"Articles\");","map":{"version":3,"sources":["/Users/nguyencanhnguyen/Public/Development/condi-app/src/pages/Articles/index.tsx"],"names":["useEffect","useState","useHistory","useParams","NavLink","userByToken","deleteFavorite","postFavorite","getProfile","deleteArticle","deleteFollowing","getArticle","getArticleNoToken","postFollowing","Comment","AlertDialog","Articles","slug","token","window","localStorage","getItem","article","setArticle","checkAuthor","setCheckAuthor","likeCount","setLikeCount","favoritesCount","likeState","setLikeState","followState","setFollowState","open","setOpen","history","then","responseArticle","data","favorited","responseUser","user","username","author","res","profile","following","handleFavorite","handleFollowing","handleDelete","handleAgree","push","handleClose","title","image","updatedAt","body","tagList","map","tag"],"mappings":"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","sourcesContent":["import { useEffect, useState } from \"react\";\nimport { useHistory, useParams } from \"react-router\";\nimport { NavLink } from \"react-router-dom\";\nimport { userByToken } from \"../../apis\";\nimport {\n  deleteFavorite,\n  postFavorite,\n} from \"../Home/components/ArticlePreview/ArticleItem/apis\";\nimport { getProfile } from \"../Profile/apis\";\nimport {\n  deleteArticle,\n  deleteFollowing,\n  getArticle,\n  getArticleNoToken,\n  postFollowing,\n} from \"./apis\";\nimport { AxiosResponse } from \"axios\";\nimport Comment from \"./Components/Comment\";\nimport AlertDialog from \"../../components/Modals/AlertDialog\";\n\nexport default function Articles() {\n  const { slug }: any = useParams();\n  const token = window.localStorage.getItem(\"jwtToken\") as string;\n  const [article, setArticle] = useState<any>();\n  const [checkAuthor, setCheckAuthor] = useState(false);\n  const [likeCount, setLikeCount] = useState<number>(article?.favoritesCount);\n  const [likeState, setLikeState] = useState<boolean>();\n  const [followState, setFollowState] = useState<boolean>();\n  const [open, setOpen] = useState(false);\n  const history = useHistory();\n\n  useEffect(() => {\n    if (token) {\n      getArticle(slug, token).then((responseArticle) => {\n        setArticle(responseArticle.data.article);\n        setLikeState(responseArticle.data.article?.favorited);\n        setLikeCount(responseArticle.data.article?.favoritesCount);\n        userByToken(token).then((responseUser) => {\n          if (\n            responseUser.data.user.username ==\n            responseArticle.data.article.author.username\n          )\n            setCheckAuthor(true);\n          else setCheckAuthor(false);\n        });\n        getProfile(token, responseArticle.data.article.author.username).then(\n          (res: AxiosResponse<any>) => {\n            if (res.data.profile.following) setFollowState(true);\n            else setFollowState(false);\n          }\n        );\n      });\n    } else {\n      getArticleNoToken(slug).then((res: any) => {\n        setArticle(res.data.article);\n      });\n    }\n  }, [slug, token]);\n\n  const handleFavorite = (slug: string) => {\n    if (likeState) {\n      deleteFavorite(token, slug).then((res: any) => {\n        setLikeCount(res.data.article?.favoritesCount);\n        setLikeState(false);\n      });\n    } else {\n      postFavorite(token, slug).then((res: any) => {\n        setLikeCount(res.data.article?.favoritesCount);\n        setLikeState(true);\n      });\n    }\n  };\n  const handleFollowing = (username: string) => {\n    if (followState) {\n      deleteFollowing(token, username).then((res: any) => {\n        // setLikeCount(res.data.article?.favoritesCount);\n\n        setFollowState(false);\n      });\n    } else {\n      postFollowing(token, username).then((res: any) => {\n        // setLikeCount(res.data.article?.favoritesCount);\n\n        setFollowState(true);\n      });\n    }\n  };\n  const handleDelete = () => {\n    setOpen(true);\n  };\n\n  const handleAgree = () => {\n    deleteArticle(slug, token).then((res) => {\n      history.push(\"\");\n    });\n    handleClose();\n  };\n\n  const handleClose = () => {\n    setOpen(false);\n  };\n\n  return (\n    <div className=\"article-page\">\n      <AlertDialog\n        open={open}\n        setOpen={setOpen}\n        slug={slug}\n        token={token}\n        handleAgree={handleAgree}\n        handleClose={handleClose}\n      />\n      <div className=\"banner\">\n        <div className=\"container\">\n          <h1>{article?.title}</h1>\n          <div className=\"article-meta\">\n            <img\n              src={\n                article?.author?.image\n                  ? article.author.image\n                  : \"https://static.productionready.io/images/smiley-cyrus.jpg\"\n              }\n              alt=\"\"\n            />\n            <div className=\"info\">\n              <NavLink to={\"/profile/\" + article?.author?.username}>\n                <h5>{article?.author?.username}</h5>\n              </NavLink>\n              <span className=\"date\">{article?.updatedAt}</span>\n            </div>\n            {token ? (\n              <div>\n                {checkAuthor ? (\n                  <div>\n                    <NavLink to={\"/editor/\" + article?.slug}>\n                      <button className=\"btn btn-sm btn-outline-secondary\">\n                        <i className=\"ion-edit\"></i>\n                        &nbsp; Edit Article\n                      </button>\n                    </NavLink>\n                    &nbsp;&nbsp;\n                    <button\n                      className=\"btn btn-sm btn-outline-danger\"\n                      onClick={handleDelete}\n                    >\n                      <i className=\"ion-trash-a\"></i>\n                      &nbsp; Delete Article\n                    </button>\n                  </div>\n                ) : (\n                  <div>\n                    <button\n                      className=\"btn btn-sm btn-outline-secondary\"\n                      onClick={() => handleFollowing(article?.author?.username)}\n                    >\n                      {followState ? (\n                        <i></i>\n                      ) : (\n                        <i className=\"ion-plus-round\"></i>\n                      )}\n                      &nbsp;{\" \"}\n                      {followState\n                        ? `Unfollow ${article?.author?.username}`\n                        : `Follow ${article?.author?.username}`}\n                      <span className=\"counter\"></span>\n                    </button>\n                    &nbsp;&nbsp;\n                    <button\n                      className={\n                        likeState\n                          ? \"btn btn-sm btn-primary\"\n                          : \"btn btn-sm btn-outline-primary\"\n                      }\n                      onClick={() => handleFavorite(article?.slug)}\n                    >\n                      {likeState ? <i></i> : <i className=\"ion-heart\"></i>}\n                      &nbsp; {likeState ? \"Unfavorite Post\" : \"Favorite Post\"}\n                      <span className=\"counter\">({likeCount})</span>\n                    </button>\n                  </div>\n                )}\n              </div>\n            ) : (\n              <div></div>\n            )}\n          </div>\n        </div>\n      </div>\n      <div className=\"container page\">\n        <div className=\"row article-content\">\n          <div className=\"col-xs-12\">\n            <p>{article?.body}</p>\n          </div>\n        </div>\n        <div className=\"tag-list\">\n          {article?.tagList?.map((tag: any) => (\n            <span\n              key={tag}\n              ng-repeat=\"tag in $ctrl.article.tagList\"\n              className=\"tag-default tag-pill ng-binding ng-scope\"\n            >\n              {tag}\n            </span>\n          ))}\n        </div>\n        <hr />\n        <Comment slug={slug} />\n      </div>\n      {/* <Route path=\"/editor/:slug\">\n        <Editor />\n      </Route> */}\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}