{"ast":null,"code":"import _slicedToArray from\"/Users/nguyencanhnguyen/Public/Development/condi-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useEffect,useState}from\"react\";import{useHistory,useParams}from\"react-router\";import{NavLink}from\"react-router-dom\";import{userByToken}from\"../../apis\";import{deleteFavorite,postFavorite}from\"../Home/components/ArticlePreview/ArticleItem/apis\";import{getProfile}from\"../Profile/apis\";import{deleteArticle,deleteFollowing,getArticle,postFollowing}from\"./apis\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Articles(){var _article$author,_article$author2,_article$author3,_article$author5,_article$author6,_article$tagList;var _useParams=useParams(),slug=_useParams.slug;var token=window.localStorage.getItem(\"jwtToken\");var _useState=useState(),_useState2=_slicedToArray(_useState,2),article=_useState2[0],setArticle=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),checkAuthor=_useState4[0],setCheckAuthor=_useState4[1];var _useState5=useState(article===null||article===void 0?void 0:article.favoritesCount),_useState6=_slicedToArray(_useState5,2),likeCount=_useState6[0],setLikeCount=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),likeState=_useState8[0],setLikeState=_useState8[1];var history=useHistory();var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),followState=_useState10[0],setFollowState=_useState10[1];useEffect(function(){getArticle(slug,token).then(function(responseArticle){var _responseArticle$data,_responseArticle$data2;console.log(responseArticle);setArticle(responseArticle.data.article);setLikeState((_responseArticle$data=responseArticle.data.article)===null||_responseArticle$data===void 0?void 0:_responseArticle$data.favorited);setLikeCount((_responseArticle$data2=responseArticle.data.article)===null||_responseArticle$data2===void 0?void 0:_responseArticle$data2.favoritesCount);userByToken(token).then(function(responseUser){if(responseUser.data.user.username==responseArticle.data.article.author.username)setCheckAuthor(true);else setCheckAuthor(false);});getProfile(token,responseArticle.data.article.author.username).then(function(res){if(res.data.profile.following)setFollowState(true);else setFollowState(false);});});},[slug]);var handleFavorite=function handleFavorite(slug){if(likeState){deleteFavorite(token,slug).then(function(res){var _res$data$article;setLikeCount((_res$data$article=res.data.article)===null||_res$data$article===void 0?void 0:_res$data$article.favoritesCount);setLikeState(false);});}else{postFavorite(token,slug).then(function(res){var _res$data$article2;setLikeCount((_res$data$article2=res.data.article)===null||_res$data$article2===void 0?void 0:_res$data$article2.favoritesCount);setLikeState(true);});}};var handleFollowing=function handleFollowing(username){if(followState){deleteFollowing(token,username).then(function(res){setFollowState(false);});}else{postFollowing(token,username).then(function(res){setFollowState(true);});}};var handleDelete=function handleDelete(){deleteArticle(slug,token).then(function(res){history.push(\"\");});};return/*#__PURE__*/_jsxs(\"div\",{className:\"article-page\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"banner\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:article===null||article===void 0?void 0:article.title}),/*#__PURE__*/_jsxs(\"div\",{className:\"article-meta\",children:[/*#__PURE__*/_jsx(\"img\",{src:(article===null||article===void 0?void 0:(_article$author=article.author)===null||_article$author===void 0?void 0:_article$author.image)?article.author.image:\"https://static.productionready.io/images/smiley-cyrus.jpg\",alt:\"\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"info\",children:[/*#__PURE__*/_jsx(NavLink,{to:\"/profile/\"+(article===null||article===void 0?void 0:(_article$author2=article.author)===null||_article$author2===void 0?void 0:_article$author2.username),children:/*#__PURE__*/_jsx(\"h5\",{children:article===null||article===void 0?void 0:(_article$author3=article.author)===null||_article$author3===void 0?void 0:_article$author3.username})}),/*#__PURE__*/_jsx(\"span\",{className:\"date\",children:article===null||article===void 0?void 0:article.updatedAt})]}),token?/*#__PURE__*/_jsx(\"div\",{children:checkAuthor?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(NavLink,{to:\"/editor/\"+(article===null||article===void 0?void 0:article.slug),children:/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn-sm btn-outline-secondary\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"ion-edit\"}),\"\\xA0 Edit Article\"]})}),\"\\xA0\\xA0\",/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn-sm btn-outline-danger\",onClick:handleDelete,children:[/*#__PURE__*/_jsx(\"i\",{className:\"ion-trash-a\"}),\"\\xA0 Delete Article\"]})]}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn-sm btn-outline-secondary\",onClick:function onClick(){var _article$author4;return handleFollowing(article===null||article===void 0?void 0:(_article$author4=article.author)===null||_article$author4===void 0?void 0:_article$author4.username);},children:[followState?/*#__PURE__*/_jsx(\"i\",{}):/*#__PURE__*/_jsx(\"i\",{className:\"ion-plus-round\"}),\"\\xA0\",\" \",followState?\"Unfollow \".concat(article===null||article===void 0?void 0:(_article$author5=article.author)===null||_article$author5===void 0?void 0:_article$author5.username):\"Follow \".concat(article===null||article===void 0?void 0:(_article$author6=article.author)===null||_article$author6===void 0?void 0:_article$author6.username),/*#__PURE__*/_jsx(\"span\",{className:\"counter\"})]}),\"\\xA0\\xA0\",/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn-sm btn-outline-primary\",onClick:function onClick(){return handleFavorite(article===null||article===void 0?void 0:article.slug);},children:[likeState?/*#__PURE__*/_jsx(\"i\",{}):/*#__PURE__*/_jsx(\"i\",{className:\"ion-heart\"}),\"\\xA0 \",likeState?\"Unfavorite Post\":\"Favorite Post\",/*#__PURE__*/_jsxs(\"span\",{className:\"counter\",children:[\"(\",likeCount,\")\"]})]})]})}):/*#__PURE__*/_jsx(\"div\",{})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"container page\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"row article-content\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-md-12\",children:/*#__PURE__*/_jsx(\"p\",{children:article===null||article===void 0?void 0:article.body})})}),/*#__PURE__*/_jsx(\"div\",{className:\"tag-list\",children:article===null||article===void 0?void 0:(_article$tagList=article.tagList)===null||_article$tagList===void 0?void 0:_article$tagList.map(function(tag){return/*#__PURE__*/_jsx(\"span\",{\"ng-repeat\":\"tag in $ctrl.article.tagList\",className:\"tag-default tag-pill ng-binding ng-scope\",children:tag},tag);})}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-xs-12 col-md-8 offset-md-2\",children:[/*#__PURE__*/_jsxs(\"form\",{className:\"card comment-form\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-block\",children:/*#__PURE__*/_jsx(\"textarea\",{className:\"form-control\",placeholder:\"Write a comment...\",rows:3})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-footer\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"http://i.imgur.com/Qr71crq.jpg\",className:\"comment-author-img\",alt:\"\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-sm btn-primary\",children:\"Post Comment\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-block\",children:/*#__PURE__*/_jsx(\"p\",{className:\"card-text\",children:\"With supporting text below as a natural lead-in to additional content.\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-footer\",children:[/*#__PURE__*/_jsx(\"a\",{href:\"\",className:\"comment-author\",children:/*#__PURE__*/_jsx(\"img\",{src:\"http://i.imgur.com/Qr71crq.jpg\",className:\"comment-author-img\",alt:\"\"})}),\"\\xA0\",/*#__PURE__*/_jsx(\"a\",{href:\"\",className:\"comment-author\",children:\"Jacob Schmidt\"}),/*#__PURE__*/_jsx(\"span\",{className:\"date-posted\",children:\"Dec 29th\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-block\",children:/*#__PURE__*/_jsx(\"p\",{className:\"card-text\",children:\"With supporting text below as a natural lead-in to additional content.\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-footer\",children:[/*#__PURE__*/_jsx(\"a\",{href:\"\",className:\"comment-author\",children:/*#__PURE__*/_jsx(\"img\",{src:\"http://i.imgur.com/Qr71crq.jpg\",className:\"comment-author-img\",alt:\"\"})}),\"\\xA0\",/*#__PURE__*/_jsx(\"a\",{href:\"\",className:\"comment-author\",children:\"Jacob Schmidt\"}),/*#__PURE__*/_jsx(\"span\",{className:\"date-posted\",children:\"Dec 29th\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"mod-options\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"ion-edit\"}),/*#__PURE__*/_jsx(\"i\",{className:\"ion-trash-a\"})]})]})]})]})})]})]});}","map":{"version":3,"sources":["/Users/nguyencanhnguyen/Public/Development/condi-app/src/pages/Articles/index.tsx"],"names":["useEffect","useState","useHistory","useParams","NavLink","userByToken","deleteFavorite","postFavorite","getProfile","deleteArticle","deleteFollowing","getArticle","postFollowing","Articles","slug","token","window","localStorage","getItem","article","setArticle","checkAuthor","setCheckAuthor","favoritesCount","likeCount","setLikeCount","likeState","setLikeState","history","followState","setFollowState","then","responseArticle","console","log","data","favorited","responseUser","user","username","author","res","profile","following","handleFavorite","handleFollowing","handleDelete","push","title","image","updatedAt","body","tagList","map","tag"],"mappings":"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","sourcesContent":["import { useEffect, useState } from \"react\";\nimport { useHistory, useParams } from \"react-router\";\nimport { NavLink } from \"react-router-dom\";\nimport { Article, Profile } from \"../../interfaces\";\nimport { userByToken } from \"../../apis\";\n\nimport {\n  deleteFavorite,\n  postFavorite,\n} from \"../Home/components/ArticlePreview/ArticleItem/apis\";\nimport { getProfile } from \"../Profile/apis\";\nimport {\n  deleteArticle,\n  deleteFollowing,\n  getArticle,\n  postFollowing,\n} from \"./apis\";\nimport { AxiosResponse } from \"axios\";\n\nexport default function Articles() {\n  const { slug }: any = useParams();\n  const token = window.localStorage.getItem(\"jwtToken\");\n  const [article, setArticle] = useState<Article>();\n  const [checkAuthor, setCheckAuthor] = useState(false);\n  const [likeCount, setLikeCount] = useState<number | undefined>(\n    article?.favoritesCount\n  );\n  const [likeState, setLikeState] = useState<boolean>();\n  const history = useHistory();\n  const [followState, setFollowState] = useState<boolean>();\n  useEffect(() => {\n    getArticle(slug, token).then((responseArticle) => {\n      console.log(responseArticle);\n      setArticle(responseArticle.data.article);\n      setLikeState(responseArticle.data.article?.favorited);\n      setLikeCount(responseArticle.data.article?.favoritesCount);\n      userByToken(token).then((responseUser) => {\n        if (\n          responseUser.data.user.username ==\n          responseArticle.data.article.author.username\n        )\n          setCheckAuthor(true);\n        else setCheckAuthor(false);\n      });\n      getProfile(token, responseArticle.data.article.author.username).then(\n        (res: AxiosResponse<any | Profile>) => {\n          if (res.data.profile.following) setFollowState(true);\n          else setFollowState(false);\n        }\n      );\n    });\n  }, [slug]);\n\n  const handleFavorite = (slug: string | undefined) => {\n    if (likeState) {\n      deleteFavorite(token, slug).then((res: any) => {\n        setLikeCount(res.data.article?.favoritesCount);\n        setLikeState(false);\n      });\n    } else {\n      postFavorite(token, slug).then((res) => {\n        setLikeCount(res.data.article?.favoritesCount);\n        setLikeState(true);\n      });\n    }\n  };\n  const handleFollowing = (username: string | undefined) => {\n    if (followState) {\n      deleteFollowing(token, username).then((res) => {\n        setFollowState(false);\n      });\n    } else {\n      postFollowing(token, username).then((res) => {\n        setFollowState(true);\n      });\n    }\n  };\n  const handleDelete = () => {\n    deleteArticle(slug, token).then((res) => {\n      history.push(\"\");\n    });\n  };\n\n  return (\n    <div className=\"article-page\">\n      <div className=\"banner\">\n        <div className=\"container\">\n          <h1>{article?.title}</h1>\n          <div className=\"article-meta\">\n            <img\n              src={\n                article?.author?.image\n                  ? article.author.image\n                  : \"https://static.productionready.io/images/smiley-cyrus.jpg\"\n              }\n              alt=\"\"\n            />\n            <div className=\"info\">\n              <NavLink to={\"/profile/\" + article?.author?.username}>\n                <h5>{article?.author?.username}</h5>\n              </NavLink>\n              <span className=\"date\">{article?.updatedAt}</span>\n            </div>\n            {token ? (\n              <div>\n                {checkAuthor ? (\n                  <div>\n                    <NavLink to={\"/editor/\" + article?.slug}>\n                      <button className=\"btn btn-sm btn-outline-secondary\">\n                        <i className=\"ion-edit\"></i>\n                        &nbsp; Edit Article\n                      </button>\n                    </NavLink>\n                    &nbsp;&nbsp;\n                    <button\n                      className=\"btn btn-sm btn-outline-danger\"\n                      onClick={handleDelete}\n                    >\n                      <i className=\"ion-trash-a\"></i>\n                      &nbsp; Delete Article\n                    </button>\n                  </div>\n                ) : (\n                  <div>\n                    <button\n                      className=\"btn btn-sm btn-outline-secondary\"\n                      onClick={() => handleFollowing(article?.author?.username)}\n                    >\n                      {followState ? (\n                        <i></i>\n                      ) : (\n                        <i className=\"ion-plus-round\"></i>\n                      )}\n                      &nbsp;{\" \"}\n                      {followState\n                        ? `Unfollow ${article?.author?.username}`\n                        : `Follow ${article?.author?.username}`}\n                      <span className=\"counter\"></span>\n                    </button>\n                    &nbsp;&nbsp;\n                    <button\n                      className=\"btn btn-sm btn-outline-primary\"\n                      onClick={() => handleFavorite(article?.slug)}\n                    >\n                      {likeState ? <i></i> : <i className=\"ion-heart\"></i>}\n                      &nbsp; {likeState ? \"Unfavorite Post\" : \"Favorite Post\"}\n                      <span className=\"counter\">({likeCount})</span>\n                    </button>\n                  </div>\n                )}\n              </div>\n            ) : (\n              <div></div>\n            )}\n          </div>\n        </div>\n      </div>\n      <div className=\"container page\">\n        <div className=\"row article-content\">\n          <div className=\"col-md-12\">\n            <p>{article?.body}</p>\n          </div>\n        </div>\n        <div className=\"tag-list\">\n          {article?.tagList?.map((tag: any) => (\n            <span\n              key={tag}\n              ng-repeat=\"tag in $ctrl.article.tagList\"\n              className=\"tag-default tag-pill ng-binding ng-scope\"\n            >\n              {tag}\n            </span>\n          ))}\n        </div>\n        <hr />\n        <div className=\"row\">\n          <div className=\"col-xs-12 col-md-8 offset-md-2\">\n            <form className=\"card comment-form\">\n              <div className=\"card-block\">\n                <textarea\n                  className=\"form-control\"\n                  placeholder=\"Write a comment...\"\n                  rows={3}\n                ></textarea>\n              </div>\n              <div className=\"card-footer\">\n                <img\n                  src=\"http://i.imgur.com/Qr71crq.jpg\"\n                  className=\"comment-author-img\"\n                  alt=\"\"\n                />\n                <button className=\"btn btn-sm btn-primary\">Post Comment</button>\n              </div>\n            </form>\n            <div className=\"card\">\n              <div className=\"card-block\">\n                <p className=\"card-text\">\n                  With supporting text below as a natural lead-in to additional\n                  content.\n                </p>\n              </div>\n              <div className=\"card-footer\">\n                <a href=\"\" className=\"comment-author\">\n                  <img\n                    src=\"http://i.imgur.com/Qr71crq.jpg\"\n                    className=\"comment-author-img\"\n                    alt=\"\"\n                  />\n                </a>\n                &nbsp;\n                <a href=\"\" className=\"comment-author\">\n                  Jacob Schmidt\n                </a>\n                <span className=\"date-posted\">Dec 29th</span>\n              </div>\n            </div>\n            <div className=\"card\">\n              <div className=\"card-block\">\n                <p className=\"card-text\">\n                  With supporting text below as a natural lead-in to additional\n                  content.\n                </p>\n              </div>\n              <div className=\"card-footer\">\n                <a href=\"\" className=\"comment-author\">\n                  <img\n                    src=\"http://i.imgur.com/Qr71crq.jpg\"\n                    className=\"comment-author-img\"\n                    alt=\"\"\n                  />\n                </a>\n                &nbsp;\n                <a href=\"\" className=\"comment-author\">\n                  Jacob Schmidt\n                </a>\n                <span className=\"date-posted\">Dec 29th</span>\n                <span className=\"mod-options\">\n                  <i className=\"ion-edit\"></i>\n                  <i className=\"ion-trash-a\"></i>\n                </span>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}