{"ast":null,"code":"import _slicedToArray from\"/Users/nguyencanhnguyen/Public/Development/condi-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useEffect,useState}from\"react\";import{useSelector}from\"react-redux\";import{NavLink}from\"react-router-dom\";import AlertDialog from\"../../../../components/Modals/AlertDialog\";import{deleteComment,getComments,getCommentsNoToken,postComment}from\"../../apis/comment\";import FormComment from\"./FormComment\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Comment(_ref){var slug=_ref.slug;var token=window.localStorage.getItem(\"jwtToken\");var _useState=useState(),_useState2=_slicedToArray(_useState,2),comments=_useState2[0],setComments=_useState2[1];var user=useSelector(function(state){var _state$user;return state===null||state===void 0?void 0:(_state$user=state.user)===null||_state$user===void 0?void 0:_state$user.data;});useEffect(function(){if(token){getComments(slug,token).then(function(res){setComments(res.data.comments);});}else{getCommentsNoToken(slug).then(function(res){setComments(res.data.comments);});}},[]);var getComment=function getComment(comment){postComment(comment,slug,token).then(function(res){getComments(slug,token).then(function(res){setComments(res.data.comments);});});};var handleDelete=function handleDelete(id){setOpen(true);setID(id);};var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),id=_useState4[0],setID=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),open=_useState6[0],setOpen=_useState6[1];var handleAgree=function handleAgree(){deleteComment(id,slug,token).then(function(res){getComments(slug,token).then(function(res){setComments(res.data.comments);});});handleClose();};var handleClose=function handleClose(){setOpen(false);};return/*#__PURE__*/_jsxs(\"div\",{className:\"article-page\",children:[/*#__PURE__*/_jsx(AlertDialog,{open:open,setOpen:setOpen,slug:slug,token:token,handleAgree:handleAgree,handleClose:handleClose}),/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-xs-12 col-md-8 offset-md-2\",children:[token?/*#__PURE__*/_jsx(FormComment,{getComment:getComment}):/*#__PURE__*/_jsx(\"div\",{}),comments===null||comments===void 0?void 0:comments.map(function(comment){var _comment$author,_comment$author2,_comment$author3,_comment$author4;return/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-block\",children:/*#__PURE__*/_jsx(\"p\",{className:\"card-text\",children:comment===null||comment===void 0?void 0:comment.body})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-footer\",children:[/*#__PURE__*/_jsx(\"img\",{src:(comment===null||comment===void 0?void 0:(_comment$author=comment.author)===null||_comment$author===void 0?void 0:_comment$author.image)?comment.author.image:\"https://static.productionready.io/images/smiley-cyrus.jpg\",className:\"comment-author-img\",alt:\"\"}),\"\\xA0\",/*#__PURE__*/_jsx(NavLink,{className:\"nav-link comment-author\",to:\"/profile/\"+(comment===null||comment===void 0?void 0:(_comment$author2=comment.author)===null||_comment$author2===void 0?void 0:_comment$author2.username),activeClassName:\"selected\",children:comment===null||comment===void 0?void 0:(_comment$author3=comment.author)===null||_comment$author3===void 0?void 0:_comment$author3.username}),/*#__PURE__*/_jsx(\"span\",{className:\"date-posted\",children:comment===null||comment===void 0?void 0:comment.updatedAt}),(user===null||user===void 0?void 0:user.username)===(comment===null||comment===void 0?void 0:(_comment$author4=comment.author)===null||_comment$author4===void 0?void 0:_comment$author4.username)?/*#__PURE__*/_jsx(\"span\",{className:\"mod-options\",children:/*#__PURE__*/_jsx(\"i\",{className:\"ion-trash-a\",onClick:function onClick(){return handleDelete(comment===null||comment===void 0?void 0:comment.id);}})}):/*#__PURE__*/_jsx(\"span\",{})]})]},comment===null||comment===void 0?void 0:comment.id);})]})})]});}","map":{"version":3,"sources":["/Users/nguyencanhnguyen/Public/Development/condi-app/src/pages/Articles/Components/Comment/index.tsx"],"names":["useEffect","useState","useSelector","NavLink","AlertDialog","deleteComment","getComments","getCommentsNoToken","postComment","FormComment","Comment","slug","token","window","localStorage","getItem","comments","setComments","user","state","data","then","res","getComment","comment","handleDelete","id","setOpen","setID","open","handleAgree","handleClose","map","body","author","image","username","updatedAt"],"mappings":"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","sourcesContent":["import { useEffect, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { NavLink } from \"react-router-dom\";\nimport { RootState } from \"../../../..\";\nimport AlertDialog from \"../../../../components/Modals/AlertDialog\";\nimport {\n  deleteComment,\n  getComments,\n  getCommentsNoToken,\n  postComment,\n} from \"../../apis/comment\";\nimport FormComment from \"./FormComment\";\n\nexport default function Comment({ slug }: { slug: string }) {\n  const token = window.localStorage.getItem(\"jwtToken\");\n  const [comments, setComments] = useState<any>();\n  const user = useSelector((state: RootState) => state?.user?.data);\n\n  useEffect(() => {\n    if (token) {\n      getComments(slug, token).then((res) => {\n        setComments(res.data.comments);\n      });\n    } else {\n      getCommentsNoToken(slug).then((res) => {\n        setComments(res.data.comments);\n      });\n    }\n  }, []);\n\n  const getComment = (comment: String) => {\n    postComment(comment, slug, token).then((res: any) => {\n      getComments(slug, token).then((res) => {\n        setComments(res.data.comments);\n      });\n    });\n  };\n  const handleDelete = (id: string) => {\n    setOpen(true);\n    setID(id);\n  };\n\n  const [id, setID] = useState<any>();\n\n  const [open, setOpen] = useState(false);\n\n  const handleAgree = () => {\n    deleteComment(id, slug, token).then((res: any) => {\n      getComments(slug, token).then((res) => {\n        setComments(res.data.comments);\n      });\n    });\n    handleClose();\n  };\n\n  const handleClose = () => {\n    setOpen(false);\n  };\n\n  return (\n    <div className=\"article-page\">\n      <AlertDialog\n        open={open}\n        setOpen={setOpen}\n        slug={slug}\n        token={token}\n        handleAgree={handleAgree}\n        handleClose={handleClose}\n      />\n      <div className=\"row\">\n        <div className=\"col-xs-12 col-md-8 offset-md-2\">\n          {token ? <FormComment getComment={getComment} /> : <div></div>}\n          {comments?.map((comment: any) => (\n            <div className=\"card\" key={comment?.id}>\n              <div className=\"card-block\">\n                <p className=\"card-text\">{comment?.body}</p>\n              </div>\n              <div className=\"card-footer\">\n                <img\n                  src={\n                    comment?.author?.image\n                      ? comment.author.image\n                      : \"https://static.productionready.io/images/smiley-cyrus.jpg\"\n                  }\n                  className=\"comment-author-img\"\n                  alt=\"\"\n                />\n                &nbsp;\n                <NavLink\n                  className=\"nav-link comment-author\"\n                  to={\"/profile/\" + comment?.author?.username}\n                  activeClassName=\"selected\"\n                >\n                  {comment?.author?.username}\n                </NavLink>\n                <span className=\"date-posted\">{comment?.updatedAt}</span>\n                {user?.username === comment?.author?.username ? (\n                  <span className=\"mod-options\">\n                    <i\n                      className=\"ion-trash-a\"\n                      onClick={() => handleDelete(comment?.id)}\n                    ></i>\n                  </span>\n                ) : (\n                  <span></span>\n                )}\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}